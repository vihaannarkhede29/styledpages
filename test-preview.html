<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-container { max-width: 800px; margin: 0 auto; }
        #contentInput { width: 100%; height: 200px; margin: 20px 0; }
        #pdfPreview { border: 1px solid #ccc; padding: 20px; min-height: 300px; background: white; }
        .error { color: red; background: #ffe6e6; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Preview Test</h1>
        <p>This is a simple test to verify the preview functionality works.</p>
        
        <div id="errorContainer"></div>
        
        <textarea id="contentInput" placeholder="Enter some content here..."># Test Document

This is a test document to verify the preview functionality.

## Features

- Feature 1
- Feature 2
- Feature 3

### Conclusion

This should display properly in the preview below.</textarea>
        
        <div id="pdfPreview">
            <p>Preview will appear here...</p>
        </div>
    </div>

    <script>
        // Simple test of the preview functionality
        const contentInput = document.getElementById('contentInput');
        const preview = document.getElementById('pdfPreview');
        const errorContainer = document.getElementById('errorContainer');
        
        function showError(message) {
            errorContainer.innerHTML = `<div class="error">Error: ${message}</div>`;
        }
        
        function updatePreview() {
            try {
                const content = contentInput.value;
                console.log('Content:', content);
                
                if (!content.trim()) {
                    preview.innerHTML = '<p>Enter content above to see preview...</p>';
                    return;
                }
                
                // Simple markdown-like parsing
                let html = content
                    .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                    .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                    .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                    .replace(/^- (.*$)/gim, '<li>$1</li>')
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\n\n/g, '</p><p>')
                    .replace(/\n/g, '<br>');
                
                // Wrap list items
                html = html.replace(/(<li>.*<\/li>)/g, '<ul>$1</ul>');
                
                // Wrap paragraphs
                if (!html.startsWith('<h') && !html.startsWith('<ul')) {
                    html = '<p>' + html + '</p>';
                }
                
                preview.innerHTML = html;
                console.log('Preview updated successfully');
                
            } catch (error) {
                console.error('Preview error:', error);
                showError(error.message);
            }
        }
        
        // Test on load
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Test page loaded');
            updatePreview();
        });
        
        // Test on input
        contentInput.addEventListener('input', updatePreview);
        
        // Test the main script
        setTimeout(() => {
            try {
                // Try to load the main script
                const script = document.createElement('script');
                script.src = 'script.js';
                script.onload = () => {
                    console.log('Main script loaded successfully');
                };
                script.onerror = () => {
                    showError('Failed to load main script.js');
                };
                document.head.appendChild(script);
            } catch (error) {
                showError('Error loading main script: ' + error.message);
            }
        }, 1000);
    </script>
</body>
</html>
